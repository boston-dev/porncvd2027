<%- include include/boot-head.html%>
<div class="container px-0">

    <style>
        .btn-active-primary {
        color: #fff;
        background-color: #007bff;
        border-color: #007bff;
        }
        .el-input__inner {
            -webkit-appearance: none;
            background-color: #fff;
            background-image: none;
            border-radius: 4px;
            border: 1px solid #dcdfe6;
            box-sizing: border-box;
            color: #606266;
            display: inline-block;
            font-size: inherit;
            height: 40px;
            line-height: 40px;
            outline: none;
            padding: 0 15px;
            transition: border-color .2s cubic-bezier(.645,.045,.355,1);
            width: 100%;
        }
        .el-button {
            display: inline-block;
            line-height: 1;
            white-space: nowrap;
            cursor: pointer;
            background: #fff;
            border: 1px solid #dcdfe6;
            color: #606266;
            -webkit-appearance: none;
            text-align: center;
            box-sizing: border-box;
            outline: none;
            margin: 0;
            transition: .1s;
            font-weight: 500;
            -moz-user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
            padding: 12px 20px;
            font-size: 14px;
            border-radius: 4px;
            color: #fff;
            background-color: #67c23a;
            border-color: #67c23a;
        }
    </style>

    <div class="my-2 px-1 videotitle">
        <h4 class="vtitle min-mx--30 ">
            <span><%=video[`title${tplLang}`]%></span></h4>
    </div>
    <div class="js-vserson hidden"></div>
    <div class="hidden js-vaid-box">
        <div style="display: flex;" >
            <input type="text" autocomplete="off" placeholder="<%=tplLang ? 'Already a VIP? Please enter the order number to verify VIP': '已經是VIP?,請輸入訂單號驗證VIP'%>" class="el-input__inner js-code">
            <button type="button" class="el-button el-button--success is-round js-check " ><!----><!----><span><%=tplLang ? 'Verify VIP': '驗證VIP'%> </span></button>
        </div>
    </div>
    <div class="mgplaylist" style="position: relative">

        <div class="playerbox <%if(!video.link.length){%> hidden <%}%>"" id="playerbox">

            <nav id="dplayer">

            </nav>
        </div>
        <div >
         <div class="js-handler my-2">
           
            <%
            for(let k=0;k<video.link.length;k++){
                var item = video.link[k];
            %>
            <button type="button" data-url="<%= video.source %><%=item.url%>" class="btn js-replay btn-outline-primary
                <%
            if(k == 0){
            %>
            btn-active-primary
            <%
            }
            %>
                    "><%=item.text%></button>
                <%
                    }
                    %>
         </div>
        <%
        if(video.tag && video.tag){
        %>
        <div class="min-mx--30 px-1 my-1">
            <%
            for(let k=0;k<video.tag.length;k++){
            %>
            <a href="/tag/<%=video.tag[k]%>/<% if(curSite){%>?site=<%=curSite%><%}%>" class="btn my-1 btn-secondary btn-sm"><%=video.tag[k]%></a>

            <%
            }
            %>
        </div>
        <%
        }
        %>
        <div class="js-vserson hidden"></div>
        <!-- <div class="sdsd playerbox js-live hidden">
            <div id="live"></div>
        </div>
        <div class="js-live-btn my-2 hidden" onclick="window.open('https://xh2.live?invite_id=37096644')">
            <button type="button" class="btn js-replay btn-outline-primary" style="color: white;
            background: rgb(114, 50, 221);
            border-color: rgb(114, 50, 221);">直播中，點擊下載APP觀看</button>
        </div> -->


        <div class="post" id="post">
        

            <div class="post-body is-collapsed" id="postBody">
                <p><%=video[`desc${tplLang}`] || video[`desc`]%></p>
                <div>
                    <%-video[`content`]%>
                </div>  
            </div>
            <div class="post-tools " style="display: flex;justify-content: center;">
            <a href="javascript:;" class="js-toggle-all">展开全部</a>
        </div>
        </div>


        <div class="m-movies js-m-movies clearfix">
            <h1 class="title min-mx--30 px-1">
                <strong>
                    <a href="javascript:;">
                        Related video
                    </a>
                </strong>
            </h1>
            <div class="js-vserson"></div>
            <%
            if(typeof docs != "undefined"){
            %>
            <%- include include/boot-list.html%>
            <%
            }
            %>

        </div>

    </div>
    
    <input type="hidden" data-type="<%-video.site%>" id="video-in" data-text="<%=tplLang ? 'The order number is a vip certificate, please copy and keep it, remember' : '訂單號為vip憑證，請複制保持，切記' %>" value="<%= JSON.stringify(video.link) %>">
   <script>
$(function () {
  var $body = $("#postBody");
  var $btn  = $(".js-toggle-all");

  $btn.on("click", function () {
    var collapsed = $body.hasClass("is-collapsed");
    $body.toggleClass("is-collapsed", !collapsed);
    $btn.text(collapsed ? "收起内容" : "展开全部");

    // 展开后把视图拉到按钮下方，体验更顺
    if (collapsed) {
      $("html,body").animate({ scrollTop: $("#post").offset().top }, 200);
    }
  });
});
</script>
   <script>
        
        var source="<%= video.source %>"
        var urlJSon=JSON.parse(document.querySelector('#video-in').value)
        urlJSon.forEach(function (item) {
            item.url=source+item.url
        })
        url=urlJSon.length ? urlJSon[0].url : ''
        var img="<%= video.img %>"
        img=img.indexOf('http') == -1 ? "<%= video.source %>"+img : img
        var types= $('#video-in').attr('data-type')
        var time=0
        var dp = new DPlayer({
            container: document.getElementById('dplayer'),
            autoplay: false,
            theme: '#FADFA3',
            loop: true,
            lang: 'zh-cn',
            screenshot: true,
            hotkey: true,
            preload: 'auto',
            /*logo: '/favicon.ico',*/
            volume: 0.7,
            mutex: true,
            video: {
                url:url,
                pic:img,
                thumbnails:img,
                type: 'auto',
            },
        });
        var trys=false;
        function switchFn(url) {
            dp.switchVideo({url:url})
            dp.play()
        }
        $('.js-replay').on('click',function () {
            var url=$(this).attr('data-url')
            $(this).addClass('btn-active-primary ').siblings().removeClass('btn-active-primary ')
            switchFn(url)
        })
    </script>
</div>

<%- include include/boot-footer.html%>
